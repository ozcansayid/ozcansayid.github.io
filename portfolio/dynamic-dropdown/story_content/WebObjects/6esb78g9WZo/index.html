<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Storyline Bootstrap Dropdown</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
  /* Saydamlık için ana container'a uygulanacak stil */
  body, html {
    background-color: transparent !important;
  }
</style>
</head>
<body class="p-3">

<div class="dropdown">
  <button class="btn btn-light dropdown-toggle form-select form-select-lg mb-3" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
    Seçiniz
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="dropdownList">
    <!-- JSON verileri buraya gelecek -->
  </ul>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  function initDropdown() {
    let player = parent.GetPlayer();

    // Storyline değişkeninden JSON string al
    let jsonString = player.GetVar("json_data");

    try {
      let data = JSON.parse(jsonString);
      let dropdownList = document.getElementById("dropdownList");
      dropdownList.innerHTML = "";

      data.forEach(item => {
        let li = document.createElement("li");
        let a = document.createElement("a");
        a.className = "dropdown-item";
        a.href = "#";
        a.innerText = item.text;

        // Seçildiğinde Storyline değişkenine yaz
        a.addEventListener("click", () => {
          player.SetVar("dropdown_active", item.text);
          document.getElementById("dropdownMenuButton").innerText = item.text;
        });

        li.appendChild(a);
        dropdownList.appendChild(li);
      });

    } catch (e) {
      console.error("JSON parse hatası:", e);
    }
  }

  window.onload = initDropdown;
</script>
</body>
</html>
